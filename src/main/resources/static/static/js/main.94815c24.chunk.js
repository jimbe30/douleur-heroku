(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{303:function(e,t,n){e.exports=n(573)},331:function(e,t,n){},556:function(e,t,n){},572:function(e,t,n){},573:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(63),o=n.n(i),c=(n(308),n(53)),l=n(52),s=n(22),u=n(605),m=n(593),d=n(606),p=n(31),f=n(42),E=n(11),h=n(607),O=n(20),b=n.n(O),v=n(34),g=n(183),y=n.n(g),j=n(25),C=n(23),N=n(27),k=n(26),I=n(29),S=n(28),P={TEST_FORM:"TEST_FORM",PRESCRIPTION_FORM:"PRESCRIPTION_FORM",INFOS_PATIENT_FORM:"infosPatient",CONFIG_ORDONNANCE_FORM:"configOrdonnance"};function R(e,t){Jt(e,t)}function x(e){var t=Object.assign({},Ht("appForms")[e]),n={},a=Object.keys(t);Array.isArray(a)&&a.filter(function(e){return!e.startsWith("error.")}).forEach(function(e){n=Object(E.a)({},n,Object(f.a)({},e,t[e]))}),Jt(e,n)}function A(e,t){var n=Object.assign({},Ht("appForms")[e]),a=Object.keys(t);Array.isArray(a)&&a.filter(function(t){return t.startsWith(e+".")||!t.includes(".")}).forEach(function(a){n=Object(E.a)({},n,Object(f.a)({},"error."+a.replace(e+".",""),t[a]))}),Jt(e,n)}var T={INFOS_TEST:"INFOS_TEST",ARBORESCENCE:"ARBORESCENCE",PRESCRIPTIONS:"PRESCRIPTIONS",PRESCRIPTION_CHOISIE:"PRESCRIPTION_CHOISIE",PRESCRIPTION_SAISIE:"PRESCRIPTION_SAISIE",ORDONNANCE_EMISE:"ORDONNANCE_EMISE"};function D(){return(D=Object(v.a)(b.a.mark(function e(){var t;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt(It.arborescenceDouleurs);case 2:t=e.sent,Jt(T.ARBORESCENCE,t.data);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _(){return(_=Object(v.a)(b.a.mark(function e(t){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt(It.ficheDouleur(t));case 2:n=e.sent,Jt(T.PRESCRIPTIONS,n.data);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function w(){return(w=Object(v.a)(b.a.mark(function e(t,n){var a,r,i;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return x(P.INFOS_PATIENT_FORM),e.next=3,Dt(t,It.nouvelleOrdonnance);case 3:if(!(a=e.sent).data){e.next=26;break}if(!(r=a.data).errors){e.next=12;break}console.log(JSON.stringify(r)),A(P.INFOS_PATIENT_FORM,r.errors),Ot(n)(ft.FORMULAIRE_ORDONNANCE),e.next=24;break;case 12:return i=a.data,e.prev=13,e.next=16,M(i);case 16:t.fileURL=e.sent,Ot(n)(ft.CONFIRMATION_ORDONNANCE),console.log("L'ordonnance a bien \xe9t\xe9 enregistr\xe9e"),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(13),console.error(e.t0);case 24:e.next=27;break;case 26:console.error("L'ordonnance n'a pas pu \xeatre correctement enregistr\xe9e");case 27:Jt(T.ORDONNANCE_EMISE,t);case 28:case"end":return e.stop()}},e,null,[[13,21]])}))).apply(this,arguments)}function M(e){return F.apply(this,arguments)}function F(){return(F=Object(v.a)(b.a.mark(function e(t){var n,a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Tt(It.ordonnanceEmise(t),{responseType:"blob"});case 3:a=e.sent,a=new Blob([a.data],{type:"application/pdf"}),n=URL.createObjectURL(a),window.navigator&&window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(a,t):window.open(n),n=(kt||"")+It.ordonnanceEmise(t),e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(0),console.error(e.t0),e.t0;case 14:return e.abrupt("return",n);case 15:case"end":return e.stop()}},e,null,[[0,10]])}))).apply(this,arguments)}var L=n(19),z=n(603),U=n(601),q=n(66);n(331);var V=function(e){var t=e.className,n=e.children,a=e.width,i=e.height,o=e.moreText,c=e.lessText,l=Object(L.a)(e,["className","children","width","height","moreText","lessText"]),s=r.a.createElement("style",null," ","\n            .truncated {\n                max-height: ".concat(i?i+";":"2rem;","\n                max-width: ").concat(a?a+";":"100%;","\n                width: ").concat(a?a+";":"100%;","\n                overflow: hidden;\n                text-overflow: ellipsis;\n            } \n            .expand, .trunc {\n                width: fit-content;\n                margin-left: auto;\n                margin-right: auto;\n            }\n            .expand::after, .trunc::after {\n                cursor: pointer;\n                color: #718293;\n                font-style: italic;\n            }\n            .expand::after {\n                content: '").concat(o||"\\0025BC","'; \n                font-size: ").concat(o?".5rem":"1rem",";\n            }         \n            .trunc::after {\n                content: '").concat(c||"\\0025B2","';\n                font-size: ").concat(c?".5rem":"1rem",";\n            }\n        ")),u=!0,m=function(e){u?(e.target.className="trunc",e.target.previousSibling.className=t||"",u=!1):(e.target.className="expand",e.target.previousSibling.className="".concat(t?t+" ":"","truncated"),u=!0)};return r.a.createElement(r.a.Fragment,null,s,r.a.createElement("div",Object.assign({className:"".concat(t?t+" ":"","truncated")},l),n),r.a.createElement("div",{onClick:m,className:"expand"}))},B=function(e){function t(e){var n;return Object(j.a)(this,t),(n=Object(N.a)(this,Object(k.a)(t).call(this,e))).handleClick=function(e){var t=n.state.activeIndex;t=t===e?-1:e,n.setState({activeIndex:t})},n.handleClick=n.handleClick.bind(Object(I.a)(n)),n.state={activeIndex:-1},n}return Object(S.a)(t,e),Object(C.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.render,a=t.componentList,r=Object(L.a)(t,["render","componentList"]);if(Array.isArray(a))return a.map(function(t,a){var i=a===e.state.activeIndex;return n({component:t,index:a,isActive:i,handleClick:e.handleClick,otherProps:r})});var i=0===this.state.activeIndex;return n({component:a,index:0,isActive:i,handleClick:this.handleClick,otherProps:r})}}]),t}(r.a.Component);function G(e){var t=e.nomenclatures,n=Object(L.a)(e,["nomenclatures"]);return r.a.createElement(B,Object.assign({render:function(e){var t=e.component,n=e.index,a=e.isActive,i=e.handleClick,o=e.otherProps;return r.a.createElement(H,Object.assign({key:n,onClick:function(){return i(n)},isActive:a,libelle:t.libelle,nomenclaturesEnfants:t.nomenclaturesEnfants},o))},componentList:t},n))}function H(e){var t=e.libelle,n=e.nomenclaturesEnfants,a=e.isActive,i=e.onClick,o=Object(L.a)(e,["libelle","nomenclaturesEnfants","isActive","onClick"]);return W({title:t,content:r.a.createElement(B,Object.assign({render:function(e){var t=e.component,n=e.index,a=e.isActive,i=e.handleClick,o=e.otherProps;return t.nomenclaturesEnfants&&t.nomenclaturesEnfants.length>0?r.a.createElement(H,Object.assign({key:n,onClick:function(){return i(n)},isActive:a,libelle:t.libelle,nomenclaturesEnfants:t.nomenclaturesEnfants},o)):r.a.createElement(J,Object.assign({key:n,onClick:function(){return i(n)},isActive:a,libelle:t.libelle,infosGenerales:t.infosGenerales,idDouleur:t.id},o))},componentList:n},o)),isActive:a,onClick:i})}function J(e){var t,n=e.libelle,a=e.infosGenerales,i=e.idDouleur,o=e.handleClickDouleur,c=e.onClick,l=e.isActive,s={float:"right",maxWidth:"100%",marginTop:"-30px",marginBottom:"3px",marginRight:"2%"};return W({title:n,content:(t=a)?r.a.createElement(r.a.Fragment,null,r.a.createElement(z.a,{primary:!0,size:"tiny",style:s,onClick:function(){return o(i)}},"Faire l'ordonnance"),r.a.createElement(V,{height:"6rem",moreText:"\u25bc ( voir plus ... )",lessText:"\u25b2 ( r\xe9duire ... )"},r.a.createElement("pre",{className:"infosBase"},t))):"",isActive:l,onClick:c})}function W(e){var t=e.title,n=e.content,a=e.isActive,i=e.onClick;return r.a.createElement(U.a,{styled:!0,className:a?"":"noborder"},r.a.createElement(U.a.Title,{active:a,index:0,onClick:i},r.a.createElement(q.a,{name:"dropdown"}),t),r.a.createElement(U.a.Content,{active:a},n))}var Y=n(602),K=n(590),X=function(e){function t(e){var n;return Object(j.a)(this,t),(n=Object(N.a)(this,Object(k.a)(t).call(this,e))).IN_PROGRESS=0,n.FINISHED=1,n.state={progression:n.IN_PROGRESS},n}return Object(S.a)(t,e),Object(C.a)(t,[{key:"error",value:function(e,t){return this.errors([e])}},{key:"errors",value:function(e,t){if(Array.isArray(e))return r.a.createElement(Y.a,Object.assign({error:!0},t),e.map(function(e,t){var n=t,a=e;return e.key&&(n=e.key),e.message&&(a=(e.key?e.key+": ":t+". ")+e.message),r.a.createElement("div",{key:n},a)}))}},{key:"componentDidMount",value:function(){var e=this;this.timeout=setTimeout(function(){e.setState({progression:e.FINISHED})},this.props.timeout?this.props.timeout:3e4)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"render",value:function(){var e=this.props,t=e.loadedObject,n=e.render,a=e.children,i=(e.timeout,Object(L.a)(e,["loadedObject","render","children","timeout"])),o=r.a.createElement(K.a,{active:!0,style:{top:"30%"}},"Chargement en cours ... veuillez patienter");return t||this.state.progression!==this.IN_PROGRESS?t&&t.error?this.error(t.error,i):t&&t.errors?this.errors(t.errors,i):t&&n?n:t&&a?a:r.a.createElement(Y.a,{error:!0},"Aucun r\xe9sultat n'a \xe9t\xe9 trouv\xe9 pour votre requ\xeate"):o}}]),t}(r.a.Component),Q=function(e){function t(e){var n;return Object(j.a)(this,t),(n=Object(N.a)(this,Object(k.a)(t).call(this,e))).handleClickDouleur=function(e){Ot(n.props)(ft.FICHE_DOULEUR,{idDouleur:e})},n.handleClickDouleur.bind(Object(I.a)(n)),n}return Object(S.a)(t,e),Object(C.a)(t,[{key:"componentDidMount",value:function(){!function(){D.apply(this,arguments)}()}},{key:"render",value:function(){return r.a.createElement(X,{loadedObject:this.props.nomenclatures},r.a.createElement("div",null,r.a.createElement(Y.a,{info:!0},"Choisissez le type de douleur concern\xe9e dans l'arborescence ci-dessous"),r.a.createElement(G,Object.assign({},this.props,{handleClickDouleur:this.handleClickDouleur}))))}}]),t}(a.Component),Z=Object(s.b)(function(e){return{nomenclatures:e.ordonnance[T.ARBORESCENCE]}})(Q),$=n(591),ee=n(594);function te(e){var t=e.prescriptions,n=e.prescriptionChoisie,i=e.clickOrdonnance,o=function(){var e=null;return n?e=n.nomenclatureDouleur:t&&t.length>0&&(e=t[0].nomenclatureDouleur),e?{libelle:e.libelle,infos:e.infosGenerales,recommandations:e.recommandations}:{}};o=o();var c=t&&t.length>0?t.length:0,l=function(){return n?r.a.createElement(Y.a,{info:!0},"Vous avez choisi l'ordonnance suivante"):0===c?r.a.createElement(Y.a,{warning:!0},"Aucune ordonnance n'est encore propos\xe9e pour cette douleur"):r.a.createElement(Y.a,{info:!0}," ".concat(c," ordonnance").concat(c>1?"s vous sont propos\xe9es":" vous est propos\xe9e"," "),r.a.createElement("br",null),"Cliquez sur le bouton correspondant \xe0 l'ordonnance de votre choix")};l=l();var s=!n&&o.recommandations&&o.recommandations.length>0?r.a.createElement(Y.a,{warning:!0,className:"infosBase"},r.a.createElement(u.a,{as:"h4"},"Remarques"),o.recommandations):"",m=function(e,t){var n=function(e){return e.split(" ; ").map(function(e){return e+"\r\n"})};if(e.medicamentsPreconises.length>0)return void 0!==t?r.a.createElement("div",{className:"infosBase"},r.a.createElement(ee.a,{container:!0,justify:"flex-start",direction:"row",alignItems:"center",spacing:2},r.a.createElement(ee.a,{item:!0},r.a.createElement(z.a,{size:"tiny",primary:!0,onClick:function(){return i(t)}},"Ordonnance ",t+1)),r.a.createElement(ee.a,{item:!0},"   ",e.medicamentsPreconises.map(function(e,t){return r.a.createElement("p",{key:t},n(e.description))})))):r.a.createElement("div",{className:"infosBase"},"   ",e.medicamentsPreconises.map(function(e,t){return r.a.createElement("p",{key:t},n(e.description))}))};return r.a.createElement("div",null,r.a.createElement("h3",null,o.libelle),l,n?r.a.createElement(a.Fragment,null,m(n),r.a.createElement($.a,null)):c>0?t.map(function(e,t){return r.a.createElement(a.Fragment,{key:t},m(e,t),r.a.createElement($.a,null))}):void 0,s)}var ne=function(e){function t(e){var n;return Object(j.a)(this,t),(n=Object(N.a)(this,Object(k.a)(t).call(this,e))).clickPrescription=function(e){!function(e){var t=Gt.getState().ordonnance,n=t&&t[T.PRESCRIPTION_CHOISIE]?t[T.PRESCRIPTION_CHOISIE]:{};JSON.stringify(n)!==JSON.stringify(e)&&R(P.PRESCRIPTION_FORM,null),Jt(T.PRESCRIPTION_CHOISIE,e)}(n.props.prescriptions[e]),Ot(n.props)(ft.FORMULAIRE_PRESCRIPTION)},n.clickPrescription.bind(Object(I.a)(n)),n}return Object(S.a)(t,e),Object(C.a)(t,[{key:"componentDidMount",value:function(){!function(e){_.apply(this,arguments)}(bt(this.props).idDouleur)}},{key:"render",value:function(){return r.a.createElement(X,{loadedObject:this.props.prescriptions},r.a.createElement(te,{clickOrdonnance:this.clickPrescription,prescriptions:this.props.prescriptions}))}}]),t}(a.Component),ae=Object(s.b)(function(e){return{prescriptions:e.ordonnance[T.PRESCRIPTIONS]}})(ne),re=n(597),ie=n(596),oe=n(113),ce=function(e){return r.a.createElement(ie.a.Radio,{checked:e.input.value===e.radioValue,label:e.label,name:e.input.name,onChange:function(t,n){n.checked;return e.input.onChange(e.radioValue)}})},le=function(e){var t=e&&e.input?e.input:{},n=t.onChange?{onChange:function(e,n){return t.onChange(n.value)}}:{};return r.a.createElement(ie.a.Select,Object.assign({},e,t,n))};var se=function(e){return r.a.createElement(ie.a.TextArea,Object.assign({},e.input,{label:e.label,placeholder:e.placeholder}))};function ue(e){this.medicamentsPreconises=e?e.medicamentsPreconises:[],this.nbMedicaments=this.medicamentsPreconises.length,this.getProduits=function(e){return this.medicamentsPreconises[e]&&this.medicamentsPreconises[e].compatibilites?this.medicamentsPreconises[e].compatibilites.map(function(e){return e.produit}):null},this.getDesignationsProduits=function(e){var t=this.getProduits(e);return t?t.map(function(e){return e.designation}):null}}var me=n(40),de=n(598),pe=n(144),fe=n(592),Ee=function(e){var t=e.handleClick,n=e.title,a=Object(L.a)(e,["handleClick","title"]);n=n||"ajouter";var i=Object(E.a)({handleClick:t,title:n},a);return r.a.createElement(ve,Object.assign({icon:"add",color:"teal"},i))},he=function(e){var t=e.index,n=e.handleClick,a=e.title,i=Object(L.a)(e,["index","handleClick","title"]);a=a||"supprimer";var o=Object(E.a)({index:t,handleClick:n,title:a},i);return r.a.createElement(ve,Object.assign({icon:"delete",color:"red"},o))},Oe=function(e){var t=e.index,n=e.handleClick,a=e.title,i=Object(L.a)(e,["index","handleClick","title"]);a=a||"valider";var o=Object(E.a)({index:t,handleClick:n,title:a},i);return r.a.createElement(ve,Object.assign({icon:"check",color:"green"},o))},be=function(e){var t=e.index,n=e.handleClick,a=e.title,i=Object(L.a)(e,["index","handleClick","title"]);a=a||"annuler";var o=Object(E.a)({index:t,handleClick:n,title:a},i);return r.a.createElement(ve,Object.assign({icon:"undo",color:"red"},o))},ve=function(e){var t=e.index,n=e.handleClick,a=e.title,i=e.icon,o=e.color,c=e.long,l=Object(L.a)(e,["index","handleClick","title","icon","color","long"]);return t=t||0,n=n||function(){},!0!==c&&i&&a?r.a.createElement(de.a,{content:a,trigger:r.a.createElement(oe.a,Object.assign({as:"a",size:"tiny",onClick:function(e){return n(e,t)}},l),r.a.createElement(q.a,{name:i,color:o||pe.a,link:!0,style:{marginRight:0,marginLeft:0}}))}):r.a.createElement(z.a,Object.assign({size:"tiny",compact:!0,icon:!0,labelPosition:"left",onClick:function(e){return n(e,t)}},l),i&&r.a.createElement(q.a,{name:i,color:o||fe.a}),a)};function ge(e){var t=e.numMedicaments,n=e.handleClickAjouter,i=e.handleClickSupprimer;return r.a.createElement(a.Fragment,null," ",Array.isArray(t)&&t.map(function(e,t){return r.a.createElement(a.Fragment,{key:t},0===t?r.a.createElement(Y.a,{info:!0},"Vous pouvez saisir librement ci-dessous les m\xe9dicaments \xe0 ajouter \xe0 votre prescription "):"",r.a.createElement(ye,{numMedicament:e,handleClickSupprimer:i}))}),r.a.createElement("div",{style:{paddingTop:"1rem"}},r.a.createElement(Ee,{title:"Ajouter un m\xe9dicament",handleClick:n})))}var ye=function(e){var t=e.numMedicament,n=e.handleClickSupprimer;return r.a.createElement(ee.a,{container:!0,spacing:1},r.a.createElement(ee.a,{item:!0,xs:4},r.a.createElement(re.a,{component:ie.a.Input,label:"D\xe9signation",name:"medicament"+t,placeholder:"m\xe9dicament"})),r.a.createElement(ee.a,{item:!0,xs:3},r.a.createElement(re.a,{component:ie.a.Input,label:"Dosage",name:"dosage"+t+0,placeholder:"dosage"})),r.a.createElement(ee.a,{item:!0,xs:3},r.a.createElement(re.a,{component:ie.a.Input,label:"Qt\xe9/prise",name:"quantite"+t,placeholder:"Nb comprim\xe9s"})),r.a.createElement(ee.a,{item:!0,xs:3},r.a.createElement(re.a,{component:le,label:"Forme",name:"forme"+t,placeholder:"Comprim\xe9 ...",options:[{key:"forme1",text:"Comprim\xe9",value:"comprim\xe9(s)"},{key:"forme2",text:"G\xe9lule",value:"g\xe9lule(s)"}]})),r.a.createElement(ee.a,{item:!0,xs:4},r.a.createElement(re.a,{component:ie.a.Input,label:"Fr\xe9quence",name:"frequence"+t,placeholder:"Nb fois / jour"})),r.a.createElement(ee.a,{item:!0,xs:3},r.a.createElement(re.a,{component:ie.a.Input,label:"Dur\xe9e",name:"duree"+t,placeholder:"Nb jours"})),r.a.createElement(ee.a,{item:!0,xs:1},r.a.createElement("div",{style:{marginLeft:"0.5rem",marginTop:"50%"}},r.a.createElement(he,{index:t,handleClick:n,title:"Supprimer le m\xe9dicament"}))))},je=function(e){function t(e){var n;return Object(j.a)(this,t),(n=Object(N.a)(this,Object(k.a)(t).call(this,e))).render=function(){return r.a.createElement(ge,{handleClickAjouter:n.ajouterMedicament,handleClickSupprimer:n.supprimerMedicament,numMedicaments:n.state.numMedicaments})},n.state={numMedicaments:[]},n.ajouterMedicament=n.ajouterMedicament.bind(Object(I.a)(n)),n.supprimerMedicament=n.supprimerMedicament.bind(Object(I.a)(n)),n}return Object(S.a)(t,e),Object(C.a)(t,[{key:"ajouterMedicament",value:function(e){var t=this.props.debutCompteur;this.state.numMedicaments.length>0&&(t=this.state.numMedicaments[this.state.numMedicaments.length-1]+1),t||(t=0);var n=[t];Array.isArray(this.state.numMedicaments)&&(n=[].concat(Object(me.a)(this.state.numMedicaments),[t])),this.setState({numMedicaments:n}),e.preventDefault()}},{key:"supprimerMedicament",value:function(e,t){var n=this.state.numMedicaments.indexOf(t);if(void 0!==n){var a=Object(me.a)(this.state.numMedicaments);a.splice(n,1),this.setState({numMedicaments:a})}e.preventDefault()}}]),t}(r.a.Component),Ce=function(e){function t(e){var n;return Object(j.a)(this,t),(n=Object(N.a)(this,Object(k.a)(t).call(this,e))).render=function(){return r.a.createElement(a.Fragment,null,r.a.createElement(Y.a,{info:!0},"Veuillez renseigner la posologie dans le formulaire ci-dessous"),r.a.createElement(ie.a,{size:"tiny",onSubmit:function(){return n.props.onSubmit(n.prescriptionSaisie())}},n.prescriptionChoisie&&n.prescriptionChoisie.medicamentsPreconises.map(function(e,t){return n.formulaireMedicament(t)}),r.a.createElement(je,{debutCompteur:n.medicaments.length}),r.a.createElement(re.a,{component:se,label:"Recommandations",name:"recommandations",placeholder:"Conseils, effets ind\xe9sirables \xe0 surveiller, cas d'arr\xeat du traitement..."}),r.a.createElement(Y.a,null,r.a.createElement($.a,{horizontal:!0,fitted:!0},r.a.createElement(u.a,{as:"h5"},"R\xe9capitulatif")),n.recapPrescription(n.prescriptionSaisie())),r.a.createElement(ie.a.Group,{inline:!0},r.a.createElement(ie.a.Button,{type:"submit",size:"tiny",primary:!0,icon:!0,labelPosition:"left"},r.a.createElement(q.a,{name:"check",color:"green"}),"Valider"),r.a.createElement(ie.a.Button,{size:"tiny",onClick:n.props.reset,icon:!0,labelPosition:"left"},r.a.createElement(q.a,{name:"delete",color:"red"}),"Annuler"))))},n.prescriptionChoisie=new ue(e.prescription),n.recapPrescription=e.recapPrescription,n.medicaments=n.prescriptionChoisie.medicamentsPreconises,n.libellesMedicaments=n.medicaments.map(function(e,t){return n.prescriptionChoisie.getDesignationsProduits(t).join(" + ")}),n.state={nbMedicaments:n.medicaments.length},n}return Object(S.a)(t,e),Object(C.a)(t,[{key:"getNbMedicaments",value:function(){return this.state.nbMedicaments}},{key:"formulaireMedicament",value:function(e){return r.a.createElement(r.a.Fragment,{key:e},r.a.createElement("div",{style:{padding:"1rem 0"}},r.a.createElement(oe.a,null,this.libellesMedicaments[e])),r.a.createElement("input",{name:"medicament"+e,type:"hidden",index:e,value:this.libellesMedicaments[e]}),r.a.createElement(ee.a,{container:!0,spacing:1},this.prescriptionChoisie.getProduits(e).map(function(t,n){return r.a.createElement(ee.a,{item:!0,xs:2,key:n},r.a.createElement(re.a,{component:ie.a.Input,label:0===n?"Dosage":"",name:"dosage"+e+n,placeholder:t.designation,required:!0}))}),r.a.createElement(ee.a,{item:!0,xs:4},r.a.createElement(re.a,{component:ie.a.Input,label:"Qt\xe9/prise",name:"quantite"+e,placeholder:"Nb comprim\xe9s",required:!0})),r.a.createElement(ee.a,{item:!0,xs:4},r.a.createElement(re.a,{component:le,label:"Forme",name:"forme"+e,placeholder:"Comprim\xe9 ...",options:[{key:"forme1",text:"Comprim\xe9",value:"comprim\xe9(s)"},{key:"forme2",text:"G\xe9lule",value:"g\xe9lule(s)"}]})),r.a.createElement(ee.a,{item:!0,xs:6},r.a.createElement(re.a,{component:ie.a.Input,label:"Fr\xe9quence",name:"frequence"+e,placeholder:"Nb fois par jour",required:!0})),r.a.createElement(ee.a,{item:!0,xs:4},r.a.createElement(re.a,{component:ie.a.Input,label:"Dur\xe9e",name:"duree"+e,placeholder:"Nb de jours",required:!0}))))}},{key:"prescriptionSaisie",value:function(){for(var e=this,t=function(t){var n=e.prescriptionChoisie.getProduits(t);return Array.isArray(n)?n.map(function(n,a){var r=e.props["dosage"+t+a];return{designation:n.designation,dosage:r}}):null},n=["quantite","forme","frequence","duree"],a={nbMedicaments:this.medicaments.length,medicaments:[],recommandations:this.props.recommandations},r=function(r){a.medicaments[r]={libelle:e.libellesMedicaments[r],produits:t(r)},n.forEach(function(t){a.medicaments[r][t]=e.props[t+r]})},i=0;i<a.nbMedicaments;i++)r(i);return a}}]),t}(r.a.Component),Ne=n(595);function ke(e){var t=e.component,n=e.formName,a=e.reset,i=e.children,o=Object(L.a)(e,["component","formName","reset","children"]),c=t||i;return c=Ie(c,n,a),r.a.createElement(c,Object.assign({},n,o)," ",i," ")}function Ie(e,t,n){var a=function(a){function i(){return Object(j.a)(this,i),Object(N.a)(this,Object(k.a)(i).apply(this,arguments))}return Object(S.a)(i,a),Object(C.a)(i,[{key:"componentDidMount",value:function(){n&&!0===n&&R(t,null)}},{key:"componentDidUpdate",value:function(e){n&&!0===n?R(t,null):JSON.stringify(e[t])!==JSON.stringify(this.props[t])&&R(t,this.props[t])}},{key:"render",value:function(){return r.a.createElement(e,this.props)}}]),i}(r.a.Component);return Object(s.b)(function(e){var a,r={};return n&&!0===n||e.appForms&&t&&(a=e.appForms[t]),e.form[t]&&(r=e.form[t].values),a?Object(E.a)(Object(f.a)({initialValues:a},t,Object(E.a)({},a,r)),r):Object(E.a)(Object(f.a)({},t,Object(E.a)({},r)),r)})(Object(Ne.a)({form:t})(a))}var Se=P.PRESCRIPTION_FORM,Pe=function(e){function t(e){var n;return Object(j.a)(this,t),(n=Object(N.a)(this,Object(k.a)(t).call(this,e))).submitPrescription=function(e){var t;t=e,Jt(T.PRESCRIPTION_SAISIE,t),Ot(n.props)(ft.FORMULAIRE_ORDONNANCE)},n.submitPrescription.bind(Object(I.a)(n)),n}return Object(S.a)(t,e),Object(C.a)(t,[{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement(te,{prescriptionChoisie:this.props.prescriptionChoisie}),this.props.prescriptionChoisie&&r.a.createElement(ke,{component:Ce,formName:Se,onSubmit:this.submitPrescription,prescription:this.props.prescriptionChoisie,recapPrescription:Re}))}}]),t}(a.Component),Re=function(e){return e&&Array.isArray(e.medicaments)?e.medicaments.map(function(e,t){return r.a.createElement("div",{key:t}," ",function(e){return Array.isArray(e.produits)?e.produits.filter(function(e){return e.dosage}).map(function(e){return e.designation+" "+e.dosage}).join(" + "):null}(e)+(e.quantite&&e.forme?", "+e.quantite+" "+e.forme:"")+(e.frequence?", "+e.frequence+" fois par jour":"")+(e.duree?" pendant "+e.duree+" jours":"")," ")}):null},xe=Object(s.b)(function(e){return{prescriptionChoisie:e.ordonnance[T.PRESCRIPTION_CHOISIE]}})(Pe),Ae=function(e){function t(e){var n;return Object(j.a)(this,t),(n=Object(N.a)(this,Object(k.a)(t).call(this,e))).inputRef=r.a.createRef(),n.openPopup=n.openPopup.bind(Object(I.a)(n)),n.closePopup=n.closePopup.bind(Object(I.a)(n)),n.clickInput=n.clickInput.bind(Object(I.a)(n)),n.checkError(),n.state={openPopup:!0,indexDisplayError:0},n}return Object(S.a)(t,e),Object(C.a)(t,[{key:"componentDidUpdate",value:function(e){this.checkError()}},{key:"checkError",value:function(){this.props.form&&(this.error=this.props.form["error."+this.props.name],this.error||(this.error=this.props.form[this.props.name+".error"])),!this.error&&this.props.error&&(this.error=this.props.error),!this.error&&this.props.errors&&(this.error=this.props.errors[this.props.name])}},{key:"clickInput",value:function(){this.error&&this.setState({indexDisplayError:this.state.indexDisplayError+1})}},{key:"openPopup",value:function(){this.setState({openPopup:!0})}},{key:"closePopup",value:function(){this.state.indexDisplayError>0&&this.setState({openPopup:!1})}},{key:"render",value:function(){var e=this,t=Object(E.a)({},this.props,{error:void 0!==this.error,name:this.props.name,onMouseOver:function(){return e.openPopup()},onMouseOut:function(){return e.closePopup()},onClick:function(){return e.clickInput()}}),n=void 0!==t.value?r.a.createElement(ie.a.Input,t):r.a.createElement(re.a,Object.assign({component:ie.a.Input},t));return this.error&&(n=r.a.createElement(de.a,{open:this.state.openPopup,size:"tiny",mouseLeaveDelay:500,hoverable:!0,on:"hover",trigger:r.a.createElement("span",{ref:this.inputRef},n)},r.a.createElement(de.a.Content,null,r.a.createElement("div",{className:"error"},this.error)))),n}}]),t}(r.a.Component),Te=function(e){function t(){return Object(j.a)(this,t),Object(N.a)(this,Object(k.a)(t).apply(this,arguments))}return Object(S.a)(t,e),Object(C.a)(t,[{key:"render",value:function(){var e=this,t=this.props[P.INFOS_PATIENT_FORM];return r.a.createElement(ie.a,{size:"small",onSubmit:function(n){return e.props.onSubmit(t,n)}},r.a.createElement(Y.a,{info:!0},"Veuillez renseigner les informations du patient dans le formulaire ci-dessous"),r.a.createElement(ee.a,{container:!0,spacing:1},r.a.createElement(ee.a,{item:!0,xs:3},r.a.createElement(Ae,{form:t,label:"Nom de famille",name:"nomPatient",placeholder:"Nom obligatoire",required:!0})),r.a.createElement(ee.a,{item:!0,xs:3},r.a.createElement(Ae,{form:t,label:"Nom usuel",name:"nomUsuPatient",placeholder:"Facultatif"})),r.a.createElement(ee.a,{item:!0,xs:3},r.a.createElement(Ae,{form:t,label:"Pr\xe9nom",name:"prenomPatient",placeholder:"Pr\xe9nom",required:!0})),r.a.createElement(ee.a,{item:!0,xs:3},r.a.createElement(Ae,{form:t,name:"dateNaissance",placeholder:"jj/mm/aaaa",label:"Date naissance",required:!0})),r.a.createElement(ee.a,{item:!0,xs:4},r.a.createElement(Ae,{form:t,label:"N\xb0 immatriculation",name:"insee",placeholder:"n\xb0 sur 13 car",required:!0})),r.a.createElement(ee.a,{item:!0,xs:6},r.a.createElement("div",{className:"field"},r.a.createElement("label",null,"Sexe")),r.a.createElement(ie.a.Group,{inline:!0},r.a.createElement(re.a,{component:ce,label:"Masculin",className:"field",name:"sexe",radioValue:"M"}),r.a.createElement(re.a,{component:ce,label:"F\xe9minin",className:"field",name:"sexe",radioValue:"F"})))),r.a.createElement("p",null),r.a.createElement(ie.a.Group,{inline:!0},r.a.createElement(ie.a.Button,{type:"submit",size:"tiny",compact:!0,primary:!0,icon:!0,labelPosition:"left"},r.a.createElement(q.a,{name:"check",color:"green"}),"Valider l'ordonnance"),r.a.createElement(ie.a.Button,{type:"reset",size:"tiny",compact:!0,icon:!0,labelPosition:"left"},r.a.createElement(q.a,{name:"delete",color:"red"}),"Annuler")))}}]),t}(r.a.Component),De=P.INFOS_PATIENT_FORM,_e=function(e){function t(e){var n;return Object(j.a)(this,t),(n=Object(N.a)(this,Object(k.a)(t).call(this,e))).submitOrdonnance=function(e,t){!function(e,t){w.apply(this,arguments)}({infosPatient:e,prescription:n.props.prescriptionSaisie},n.props.history),t.preventDefault()},n.submitOrdonnance.bind(Object(I.a)(n)),n}return Object(S.a)(t,e),Object(C.a)(t,[{key:"render",value:function(){var e=this.props.prescriptionSaisie,t=this.props[De];return e?r.a.createElement(a.Fragment,null,r.a.createElement("h3",null,this.props.libelleDouleur),r.a.createElement(Te,Object.assign({onSubmit:this.submitOrdonnance},this.props)),r.a.createElement("p",null),r.a.createElement(Y.a,null,r.a.createElement($.a,{horizontal:!0,fitted:!0},r.a.createElement(u.a,{as:"h5"},"Votre ordonnance")),t&&r.a.createElement(a.Fragment,null,r.a.createElement(oe.a,null,"Patient"),r.a.createElement("div",{style:{margin:"20px 10px"}},we(t))),r.a.createElement(oe.a,null,"Prescription"),r.a.createElement("div",{style:{margin:"20px 10px"}},Re(e),e.recommandations&&r.a.createElement("p",null," ",r.a.createElement("b",null," Recommandations "),r.a.createElement("div",{className:"infosBase"},e.recommandations))))):r.a.createElement(Y.a,{error:!0}," Erreur : Aucune prescription saisie !!! ")}}]),t}(a.Component),we=function(e){return e?r.a.createElement("div",null," ",Object.keys(e).map(function(t){switch(t){case"nomPatient":return e[t];case"dateNaissance":return" - n\xe9(e) le "+e[t];case"insee":return r.a.createElement("p",null,"n\xb0 immatriculation ",e[t]);case"nomUsuPatient":case"prenomPatient":return" - "+e[t];default:return""}})," "):null},Me=Object(s.b)(function(e){return{prescriptionSaisie:e.ordonnance[T.PRESCRIPTION_SAISIE],libelleDouleur:e.ordonnance[T.PRESCRIPTION_CHOISIE]?e.ordonnance[T.PRESCRIPTION_CHOISIE].nomenclatureDouleur.libelle:""}})(Ie(_e,De));var Fe=Object(s.b)(function(e){return{ordonnance:e.ordonnance[T.ORDONNANCE_EMISE]}})(function(e){var t=e.ordonnance;return Object(L.a)(e,["ordonnance"]),r.a.createElement(X,{loadedObject:t},t&&t.fileURL?r.a.createElement(Y.a,{info:!0},r.a.createElement("p",null,"Votre ordonnance a bien \xe9t\xe9 enregistr\xe9e."),r.a.createElement("p",null,"Si elle ne s'affiche pas automatiquement, vous pouvez y acc\xe9der en cliquant le lien suivant"),r.a.createElement("a",{id:"ordo",title:"ordonnance \xe9mise",href:t.fileURL,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(z.a,{primary:!0,icon:!0,labelPosition:"left",size:"small"},r.a.createElement(q.a,{name:"file outline"}),"Editer l'ordonnance"))):r.a.createElement(Y.a,{error:!0},"Un probl\xe8me est survenu : l'ordonnance n'a pas pu \xeatre \xe9mise. Veuillez recommencer ult\xe9rieurement"))}),Le=n(143),ze=n(41),Ue=n(604),qe=n(190),Ve=n(99),Be=n(96),Ge=n(281);function He(e){var t=e.text,n=e.helpText,a=e.type,i=Object(L.a)(e,["text","helpText","type"]),o="question",c="blue";switch(a){case"info":o="info";break;case"warning":o="exclamation",c="yellow";break;case"error":o="bolt",c="red"}return t&&(o+=" circle"),r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{style:{verticalAlign:"middle"}},t),r.a.createElement(de.a,{size:"small",mouseLeaveDelay:200,hoverable:!0,on:"hover",trigger:r.a.createElement(q.a,Object.assign({name:o,color:c,style:{marginLeft:"0.7rem",marginBottom:"0.5rem"}},i))},r.a.createElement(de.a.Content,null,n)))}function Je(e){var t=e.produit,n=e.majProduit,i=e.numProduit,o=(Object(L.a)(e,["produit","majProduit","numProduit"]),Object(a.useContext)(nt)),c=o.listeProduits,l=o.listeUnitesDosage,s=c.map(function(e){return{value:e.id,text:e.designation}}),u=l.map(function(e){return{value:e,text:e}});t||(t={}),t.uniteDosage||(t.uniteDosage="mg");var d=t.listeDosages?t.listeDosages:[];function p(e,a){if(n){var r=a.value,i={};"idProduit"===e&&(i.designation=c.find(function(e){return e.id===r}).designation),n(Object(E.a)({},t,Object(f.a)({},e,r),i))}}function h(e,a){var r=e.value,i=Object(me.a)(d);r?i[a]=r:i.splice(a,1),n&&n(Object(E.a)({},t,{listeDosages:i,focus:e.name}))}function O(e){return t.errors["listeDosages["+e+"]"]?t.errors["listeDosages["+e+"]"]:null}return Object(a.useEffect)(function(){if(t.focus){var e=document.querySelector("input[name=".concat(t.focus,"]"));t.focus=null,e&&e.focus()}},[t.focus]),r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,{verticalAlign:"middle",padded:!0},r.a.createElement(m.a.Row,null,r.a.createElement(m.a.Column,{width:10},r.a.createElement(le,{inline:!0,onChange:function(e,t){return p("idProduit",t)},label:"D\xe9signation",title:"Choisissez un produit dans la liste propos\xe9e",name:"idProduit"+i,options:s,value:t?t.idProduit:"",placeholder:"d\xe9signation",required:!0}))),r.a.createElement(m.a.Row,null,r.a.createElement(m.a.Column,{width:4},r.a.createElement(le,{inline:!0,required:!0,onChange:function(e,t){return p("uniteDosage",t)},label:"Unit\xe9 dosage",name:"uniteDosage"+i,options:u,value:t.uniteDosage})),r.a.createElement(m.a.Column,{width:3},r.a.createElement(He,{text:"Dosages",helpText:"renseigner les dosages possibles : 4 occurrences maxi"})),r.a.createElement(m.a.Column,{width:9},r.a.createElement(Ge.a,{widths:d.length+1,unstackable:!0},d.map(function(e,t){return r.a.createElement(Ae,{placeholder:"dosage",key:t,error:O(t),name:"dosage"+i+"_"+t,value:e,onChange:function(e){return h(e.target,t)}})}),d.length<4&&r.a.createElement(Ae,{placeholder:"dosage",required:0===d.length,name:"dosage"+i+"_"+d.length,value:"",onChange:function(e){return h(e.target,d.length)}}))))))}function We(e){var t=!0,n={};return Array.isArray(e.medicaments)&&0!==e.medicaments.length?e.medicaments.forEach(function(e){var n=Ye(e);t=!0===t&&n}):(n={medicaments:"L'ordonnance doit comporter au moins 1 m\xe9dicament"},t=!1),e.errors=n,t}function Ye(e){var t=!0,n={};return Array.isArray(e.formes)&&0!==e.formes.length||(n={formes:"Le m\xe9dicament doit \xeatre associ\xe9 au moins \xe0 1 forme m\xe9dicamenteuse"},t=!1),Array.isArray(e.produits)&&0!==e.produits.length?e.produits.forEach(function(e){var n=function(e){var t=!0,n={};e.idProduit||(n=Object(E.a)({},n,{idProduit:"La d\xe9signation du produit est obligatoire"}),t=!1);Array.isArray(e.listeDosages)&&0!==e.listeDosages.length?e.listeDosages.forEach(function(e,a){if(isNaN(e)){var r="listeDosages["+a+"]";n=Object(E.a)({},n,Object(f.a)({},r,"Le dosage doit \xeatre num\xe9rique")),t=!1}}):(n=Object(E.a)({},n,{listeDosages:"Au moins un dosage est obligatoire (format num\xe9rique)"}),t=!1);return e.errors=n,t}(e);t=!0===t&&n}):(n={produits:"Le m\xe9dicament doit comporter au moins 1 produit"},t=!1),e.errors=n,t}function Ke(e){return Array.isArray(e.medicaments)&&(e.description=e.medicaments.map(function(e){return function(e){Array.isArray(e.produits)&&(e.description=e.produits.map(function(e){return function(e){var t=e.designation;Array.isArray(e.listeDosages)&&(t+=" "+e.listeDosages.join(" ou ")+" "+e.uniteDosage);return e.description=t,e.description}(e)}).join(" + "));return e.description}(e)}).join(" ; ")),e.description}function Xe(e){var t=e.produits,n=e.formes,i=e.numMedicament,o=e.majMedicament,c={produits:t,formes:n},l=Object(a.useContext)(nt).formesMedicamenteuses.map(function(e){return{value:e,text:e}}),s=Ye(c);function u(){if(o){var e=t?[].concat(Object(me.a)(t),[{idProduit:""}]):[{idProduit:""}];o(Object(E.a)({},c,{produits:e}))}}function d(e){return function(n){if(o){var a=Object(me.a)(t);a.splice(e,1,n),o(Object(E.a)({},c,{produits:a}))}}}return r.a.createElement(r.a.Fragment,null,r.a.createElement(function(){var e,n=r.a.createElement(r.a.Fragment,null,r.a.createElement("strong",null,"Sont obligatoires les infos suivantes :"),r.a.createElement("br",null),"Au moins une forme m\xe9dicamenteuse et un produit, avec pour chaque produit les dosages possibles");return Array.isArray(t)&&(e=t.map(function(e){return e.designation}).join(" + ")),e?s||(e=r.a.createElement(He,{helpText:n,type:"warning",text:e})):e=r.a.createElement(He,{helpText:n,text:"Ajout d'un m\xe9dicament"}),r.a.createElement("h6",null,e)},null),r.a.createElement(function(){return r.a.createElement(m.a,{padded:!0},r.a.createElement(m.a.Row,null,r.a.createElement(m.a.Column,{width:"6",style:{paddingLeft:"0"}},r.a.createElement(ze.a,{inline:!0,control:"select",label:"Formes m\xe9dicamenteuses",onChange:function(e){var t;(t=e.target.value)&&(!n||n.indexOf(t)<0)&&o(Object(E.a)({},c,{formes:n?[].concat(Object(me.a)(n),[t]):[t]}))},style:{color:"#a0a0a0"},name:"formes"+i,defaultValue:""},r.a.createElement("option",{value:"",disabled:!0},"- choisir -"),l.map(function(e,t){return r.a.createElement("option",{key:t,value:e.value},e.text)})))),r.a.createElement(m.a.Row,null," ",Array.isArray(n)&&n.length>0&&r.a.createElement(m.a.Column,{width:"16"},n.map(function(e,t){return r.a.createElement(oe.a,{key:t},e," ",r.a.createElement(he,{handleClick:function(e){return function(e){var t=Object(me.a)(n);t.splice(e,1),o(Object(E.a)({},c,{formes:t}))}(t)}}))}))))},null),r.a.createElement(function(){return Array.isArray(t)&&t.length>=1?r.a.createElement(Ue.a,null,r.a.createElement(qe.a,null,t.map(function(e,n){return r.a.createElement(Ve.a,{key:n},r.a.createElement(Be.a,null,r.a.createElement(Je,{produit:e,numProduit:i+"_"+n,majProduit:d(n)})),r.a.createElement(Be.a,{verticalAlign:"middle"},r.a.createElement(he,{size:"tiny",handleClick:function(){return function(e){if(o){var n=Object(me.a)(t);n.splice(e,1),o(Object(E.a)({},c,{produits:n}))}}(n)},title:"Supprimer ce produit"})))}))):(u(),"")},null),s&&r.a.createElement(Ee,{size:"mini",long:!0,handleClick:function(){return u()},title:"Ajouter un produit"}))}var Qe="nomenclature",Ze={ORDONNANCE_TYPE:"ordonnanceType",LISTE_ORDONNANCES_TYPES:"listeOrdonnancesTypes",PROTOCOLE_DOULEUR:"protocoleDouleur",NOMENCLATURE_DOULEUR:"nomenclatureDouleur"};function $e(){return($e=Object(v.a)(b.a.mark(function e(t,n){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=n.history,Ke(t),Jt(Ze.ORDONNANCE_TYPE,t),Ot(a)(ft.ORDONNANCES_TYPES);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function et(e){var t=function(e){var t=Gt.getState()[Qe][e];if(t)return t instanceof Array?Object(me.a)(t):t instanceof Object?Object(E.a)({},t):void 0}(Ze.LISTE_ORDONNANCES_TYPES);Array.isArray(t)?t.find(function(t){return JSON.stringify(t)===JSON.stringify(e)})||t.push(e):t=[e],Jt(Ze.LISTE_ORDONNANCES_TYPES,t)}function tt(e){var t=e.description,n=e.medicaments,i=e.mode,o=Object(L.a)(e,["description","medicaments","mode"]);n=Array.isArray(n)?n:[];var c=Object(a.useState)({description:t,medicaments:n}),l=Object(Le.a)(c,2),s=l[0],u=l[1];function d(){u(function(e){n=[].concat(Object(me.a)(e.medicaments),[{}]);var t=Object(E.a)({},e,{medicaments:n});return t.isOrdonnanceValide=We(t),t})}function p(e){return function(t){u(function(a){(n=Object(me.a)(a.medicaments)).splice(e,1,t);var r=Object(E.a)({},a,{medicaments:n});return r.isOrdonnanceValide=We(r),r})}}function f(){!function(e,t){$e.apply(this,arguments)}(s,o),et(s)}return r.a.createElement(m.a,null,r.a.createElement(function(){return r.a.createElement(m.a.Row,{verticalAlign:"middle"},r.a.createElement(m.a.Column,{width:10,textAlign:"center"},r.a.createElement("h4",null,i," Ordonnance type"),t&&r.a.createElement(oe.a,{color:"blue",size:"large",basic:!0},t),r.a.createElement(Y.a,{info:!0},r.a.createElement("strong",null," ",s.description?r.a.createElement("span",null,s.description):"Veuillez ajouter ci-dessous au moins un m\xe9dicament pour valider l'ordonnance"))))},null),r.a.createElement(function(){return Array.isArray(s.medicaments)&&s.medicaments.length>=1?s.medicaments.map(function(e,t){return r.a.createElement(m.a.Row,{key:t},r.a.createElement(m.a.Column,{textAlign:"center",width:"1",style:{padding:0}},r.a.createElement(he,{title:"Supprimer ce m\xe9dicament",handleClick:function(){return function(e){u(function(t){(n=Object(me.a)(t.medicaments)).splice(e,1);var a=Object(E.a)({},t,{medicaments:n});return a.isOrdonnanceValide=We(a),a})}(t)}})),r.a.createElement(m.a.Column,{width:"15"},r.a.createElement(Xe,Object.assign({},e,{numMedicament:t,majMedicament:p(t)})),r.a.createElement($.a,null)))}):(d(),"")},null),r.a.createElement(function(){return r.a.createElement(m.a.Row,{verticalAlign:"middle"},r.a.createElement(m.a.Column,{width:5,textAlign:"left"},s.isOrdonnanceValide&&r.a.createElement(Ee,{size:"tiny",long:!0,title:"Ajouter un m\xe9dicament",handleClick:function(){return d()}})),r.a.createElement(m.a.Column,{width:11,textAlign:"right"},s.isOrdonnanceValide&&r.a.createElement(Oe,{size:"tiny",primary:!0,long:!0,handleClick:f}),r.a.createElement(be,{size:"tiny",long:!0,handleClick:function(e){e.preventDefault()}})))},null))}var nt=Object(a.createContext)({listeProduits:[{id:1,designation:"Parac\xe9tamol"},{id:2,designation:"Tramadol"},{id:3,designation:"Cod\xe9ine"},{id:4,designation:"Poudre d'opium"}],listeUnitesDosage:["g","mg","mg LI","mg LP","\xb5g/h"],formesMedicamenteuses:["Comprim\xe9","G\xe9lule","Suppositoire","Goutte","Flasque"]});var at=n(287),rt=n(286);function it(e){var t=e.ordonnancesTypes,n=e.creerOrdonnance,a=(Object(L.a)(e,["ordonnancesTypes","creerOrdonnance"]),Array.isArray(t)?t:[{}]);function i(){n&&n()}return r.a.createElement(m.a,{padded:!0},r.a.createElement(function(){return r.a.createElement(m.a.Row,{verticalAlign:"middle"},r.a.createElement(m.a.Column,{width:10,textAlign:"center"},r.a.createElement("h4",null,"Liste des ordonnances types"),r.a.createElement(Y.a,{info:!0},r.a.createElement("strong",null,"Veuillez s\xe9lectionner une ordonnance type ci-dessous ou en cr\xe9er une nouvelle"))))},null),r.a.createElement(function(){return a.map(function(e,t){return r.a.createElement(at.a,{key:t},r.a.createElement(rt.a,null,e.description))})},null),r.a.createElement(function(){return r.a.createElement(m.a.Row,{verticalAlign:"middle"},r.a.createElement(m.a.Column,{width:5,textAlign:"left"},r.a.createElement(Ee,{size:"tiny",long:!0,title:"Nouvelle ordonnance type",handleClick:i})))},null))}var ot=Object(s.b)(function(e){return e.nomenclature?{ordonnancesTypes:e.nomenclature[Ze.LISTE_ORDONNANCES_TYPES]}:{}})(function(e){var t=e.ordonnancesTypes,n=Object(L.a)(e,["ordonnancesTypes"]),a=Object(E.a)({ordonnancesTypes:t,creerOrdonnance:function(){var e=n.history;Ot(e)(ft.GESTION_NOMENCLATURE)}},n);return r.a.createElement(it,a)}),ct=n(600),lt=n(289),st=function(e){var t=Object(E.a)({},e),n=t.message,a=t.listeIdProviders,i=a?Object.keys(a):null;return r.a.createElement(r.a.Fragment,null,n&&r.a.createElement(Y.a,{error:!0},n),r.a.createElement(u.a,{as:"h4",dividing:!0},"Pour vous connecter, s\xe9lectionnez le fournisseur d'identit\xe9 correspondant \xe0 votre compte"),Array.isArray(i)&&r.a.createElement(ct.a,{divided:!0,relaxed:!0},i.map(function(e){return r.a.createElement(ct.a.Item,{key:e},r.a.createElement(c.b,{to:(t=e,ht(ft.LOGIN_IDP,{idProvider:t}))},r.a.createElement(lt.a,{src:a[e].iconUrl,size:"mini",spaced:"right"}),r.a.createElement(ct.a.Content,null,r.a.createElement(ct.a.Header,{as:"h5"},e),r.a.createElement(ct.a.Description,null,a[e].description))));var t})))},ut=Object(s.b)(function(e){return{message:e.auth[vt.ERROR_MESSAGE],listeIdProviders:e.auth[vt.IDP_LIST]}})(function(e){var t=bt(e).idProvider,n=Object(E.a)({},e),a=n.message,i=n.listeIdProviders;return t?(yt(t),null):(i||gt(),r.a.createElement(st,{message:a,listeIdProviders:i}))}),mt=n(599),dt=Object(s.b)(function(e){return{userInfos:e.auth[vt.USER_INFOS],history:e.router.history}})(function(e){var t=Object(E.a)({},e),n=t.userInfos,a=t.history;if(n)return r.a.createElement(function(e){var t=e.fullName?e.fullName:e.preferredUsername?e.preferredUsername:e.email;return r.a.createElement("div",{style:{position:"absolute",top:"0.8rem",right:"0.8rem",zIndex:"20",fontSize:"1rem"}},r.a.createElement(mt.a,{text:t},r.a.createElement(mt.a.Menu,{direction:"left"},e.preferredUsername&&r.a.createElement(mt.a.Item,null,e.preferredUsername),e.email&&r.a.createElement(mt.a.Item,null,e.email),e.roles&&r.a.createElement(mt.a.Item,null,"R\xf4les : ",e.roles.join(", ")),r.a.createElement(mt.a.Divider,null),r.a.createElement(mt.a.Item,{onClick:Nt},r.a.createElement(q.a,{name:"power",color:"red"}),"D\xe9connexion"))))},n);var i=jt();return i&&a&&Ct(i,a),r.a.createElement(function(){return r.a.createElement("div",{style:{position:"absolute",top:"0.8rem",right:"0.8rem",zIndex:"20"}},r.a.createElement(c.b,{to:ht(ft.LOGIN_FORM)},r.a.createElement(z.a,{primary:!0,size:"small"},r.a.createElement(q.a,{name:"power"}),"Connexion")))},null)}),pt="/clientApp",ft={TEST:{key:"test",path:Et("/test"),component:qt},ARBORESCENCE:{key:"arborescence",path:Et("/douleurs"),component:Z},FICHE_DOULEUR:{key:"ficheDouleur",path:Et("/douleurs/:idDouleur"),component:ae},FORMULAIRE_PRESCRIPTION:{key:"formulairePrescription",path:Et("/prescriptionForm"),component:xe},FORMULAIRE_ORDONNANCE:{key:"formulaireOrdonnance",path:Et("/ordonnanceForm"),component:Me},CONFIRMATION_ORDONNANCE:{key:"confirmationOrdonnance",path:Et("/ordonnanceConfirm"),component:Fe},GESTION_NOMENCLATURE:{key:"gestionNomenclature",path:Et("/gestionNomenclature"),component:function(e){return r.a.createElement(ke,Object.assign({component:function(e){return r.a.createElement(ie.a,{size:"tiny",style:{marginBottom:"1rem"}},r.a.createElement(tt,e))},formName:P.CONFIG_ORDONNANCE_FORM,mode:"Saisie"},e))}},ORDONNANCES_TYPES:{key:"ordonnancesTypes",path:Et("/ordonnancesTypes"),component:ot},LOGIN_FORM:{key:"loginForm",path:Et("/login"),component:ut},LOGIN_IDP:{key:"loginIdp",path:Et("/login/:idProvider"),component:ut},VALIDATE_TOKEN:{key:"validateToken",path:Et("/token/validate"),component:dt}};function Et(e){return pt+e}var ht=function(e,t){var n=e&&e.path?e.path:e;return Object(l.d)(n,t)},Ot=function(e){var t=e.history;return t||(t=e),function(e,n){return t.push(ht(e,n))}},bt=function(e){return e&&e.match?e.match.params:{}},vt={USER_INFOS:"userInfos",ID_TOKEN:"idToken",ERROR_MESSAGE:"errorMessage",IDP_LIST:"idProvidersList",ID_PROVIDER:"idProvider"},gt=function(){var e=Object(v.a)(b.a.mark(function e(t){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt(It.idProvidersList);case 2:(n=e.sent)&&n.data&&Jt(vt.IDP_LIST,n.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),yt=function(e){var t=window.location.origin,n=It.login(e)+"?redirect_to="+t;window.location=n},jt=function(){return new URLSearchParams(window.location.search).get("id_token")},Ct=function(){var e=Object(v.a)(b.a.mark(function e(t,n){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt(It.validateToken,{params:{id_token:t}});case 2:(a=e.sent)&&a.data&&(a.data.user?(Jt(vt.USER_INFOS,a.data.user),Jt(vt.ID_TOKEN,a.data.id_token),Jt(vt.ID_PROVIDER,a.data.user.idpRegistration.registrationId)):(Jt(vt.USER_INFOS,{error:a.data.error}),Jt(vt.ID_TOKEN,null))),Ot(n)("/");case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),Nt=function(){Jt("auth"+".reset",{})},kt="",It={arborescenceDouleurs:kt+"/douleurs/arborescence",ficheDouleur:function(e){return kt+"/douleurs/"+e},nouvelleOrdonnance:kt+"/ordonnances/nouvelle",ordonnanceEmise:function(e){return kt+"/ordonnances/emises/"+e},idProvidersList:kt+"/users/login/infos",login:function(e){return kt+"/users/login/"+e},validateToken:kt+"/users/login/registerToken"},St=["application/javascript","application/json","application/xml","application/xhtml+xml","application/typescript","application/x-sh"],Pt="object",Rt="text",xt="blob",At={401:"Votre session a expir\xe9 ou l'authentification a \xe9chou\xe9, veuillez vous reconnecter",403:"Vous n'\xeates pas autoris\xe9 \xe0 acc\xe9der \xe0 cette ressource, veuillez vous identifier"},Tt=function(){var e=Object(v.a)(b.a.mark(function e(t,n){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={},n=_t(n),e.prev=2,e.next=5,y.a.get(t,n).then(function(e){a=Lt(e)});case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(2),a=Mt(e.t0),Ft(a);case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}},e,null,[[2,7]])}));return function(t,n){return e.apply(this,arguments)}}(),Dt=function(){var e=Object(v.a)(b.a.mark(function e(t,n,a){var r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={},a=_t(a),e.prev=2,e.next=5,y.a.post(n,t,a).then(function(e){r=Lt(e)});case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(2),r=Mt(e.t0),Ft(r);case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}},e,null,[[2,7]])}));return function(t,n,a){return e.apply(this,arguments)}}(),_t=function(e){var t=wt();return t&&(e||(e={}),e.headers=Object(E.a)({},e.headers,{Authorization:"Bearer "+t})),e},wt=function(){return Ht("auth")?Ht("auth")[vt.ID_TOKEN]:null},Mt=function(e){console.log("error: "+JSON.stringify(e));var t={error:e.message};if(e.response&&e.response.data){t=e.response.data;var n=At[t.status];n&&(t.message=n)}return{data:t,type:Pt,contentType:"application/json"}},Ft=function(e){if([401,403].indexOf(e.data.status)>-1){if(Gt.getState().router){var t=Gt.getState().router.history;if(t){if(Gt.getState().auth&&Gt.getState().auth.idProvider){var n=Gt.getState().auth.idProvider;Ot(t)(ft.LOGIN_IDP,{idProvider:n})}Ot(t)(ft.LOGIN_FORM)}}Jt(vt.ERROR_MESSAGE,e.data.message)}},Lt=function(){var e=Object(v.a)(b.a.mark(function e(t){var n,a,r,i;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t).data){e.next=13;break}if(a=n.data.type?n.data.type:n.headers["content-type"],n.contentType=a,n.type=Pt,!a||!a.toLowerCase().startsWith("text")&&!St.find(function(e){return a.toLowerCase().startsWith(e)})){e.next=12;break}if(!n.data.text){e.next=10;break}return e.next=9,n.data.text().then(function(e){return r=e});case 9:try{i=JSON.parse(r),n.data=i}catch(o){console.log("error: "+o),n.data=r,n.type=Rt}case 10:e.next=13;break;case 12:n.type=xt;case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),zt={REDIRECT_TEST:"redirectTest"},Ut=function(){var e=Object(v.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.location=kt+"/tests/redirect";case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();var qt=Object(s.b)(function(e){return e.test?{redirectInfo:e.test[zt.REDIRECT_TEST]}:{}})(function(e){var t=Object(E.a)({},e).history,n=new URLSearchParams(window.location.search).get("redirectInfo");return n?r.a.createElement(r.a.Fragment,null," ",n," "):(Ut(t),null)}),Vt={test:zt,nomenclature:Ze,ordonnance:T,appForms:P,auth:vt,router:{history:"history"}},Bt=Object(p.b)(Object(E.a)({},function(){var e={};return Object.keys(Vt).forEach(function(t){e[t]=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(Vt[e][n.type])return Object(E.a)({},t,Object(f.a)({},Vt[e][n.type],n.content));if("object"===typeof Vt[e]){if(n.type===e+".reset")return{};var a=Vt[e];if(Object.values(a).findIndex(function(e){return e===n.type})>=0)return Object(E.a)({},t,Object(f.a)({},n.type,n.content))}return t}}(t)}),e}(),{form:h.a}));var Gt=Object(p.c)(Bt,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());function Ht(e){return Gt.getState()[e]}function Jt(e,t){Gt.dispatch({type:e,content:t})}n(556);var Wt=n(288);n(572);function Yt(){var e=Object(a.useState)(!1),t=Object(Le.a)(e,2),n=t[0],i=t[1];return r.a.createElement(Wt.slide,{isOpen:n,onStateChange:function(e){return i(e.isOpen)}},r.a.createElement(c.b,{className:"menu-item accueil",onClick:function(){return i(!1)},to:"/"},"Accueil"),r.a.createElement(c.b,{className:"menu-item ordonnance",onClick:function(){return i(!1)},to:ht(ft.ARBORESCENCE)},"Ordonnance"),r.a.createElement(c.b,{className:"menu-item histo",onClick:function(){return i(!1)},to:ht(ft.HISTORIQUE)},"Historique"),r.a.createElement(c.b,{className:"menu-item lien",onClick:function(){return i(!1)},to:ht(ft.LIENS)},"Liens"),r.a.createElement(c.b,{className:"menu-item",onClick:function(){return i(!1)},to:ht(ft.GESTION_NOMENCLATURE)},"Configurer nomenclature"))}var Kt=function(e){return r.a.createElement(Y.a,{info:!0},r.a.createElement("div",null,r.a.createElement("h4",null,"Avec Med Pain, contr\xf4lez la douleur de vos patients "),r.a.createElement("p",null,"Acc\xe9dez aux protocoles douleur adapt\xe9s, avec rapidit\xe9 et efficacit\xe9, o\xf9 que vous soyez"),r.a.createElement("p",null,"Cliquez sur le menu en haut \xe0 gauche et s\xe9lectionnez votre choix")))};function Xt(e){var t=Object(E.a)({},e),n=t.children,a=Object(L.a)(t,["children"]),i=Object(l.f)();if(Jt("history",i),n){var o=n.type.WrappedComponent,c=n.props;return r.a.createElement(o,Object(E.a)({history:i},c,a))}return null}o.a.render(r.a.createElement(function(){var e=Math.floor(.75*window.screen.availHeight)+"px";return r.a.createElement(s.a,{store:Gt},r.a.createElement(c.a,null,r.a.createElement(Xt,null)," ",r.a.createElement(Yt,null),r.a.createElement(u.a,{as:"h2",color:"grey",textAlign:"center",inverted:!0,dividing:!0,style:{margin:0,paddingTop:"1.5rem",paddingBottom:"1.5rem",position:"fixed",top:0,left:0,zIndex:10,background:"rgb(0, 0, 0)",minWidth:"100%"}},r.a.createElement(m.a,null,r.a.createElement(m.a.Column,{width:5}),r.a.createElement(m.a.Column,{width:6},r.a.createElement("span",null,"Med Pain Pro")),r.a.createElement(m.a.Column,{width:5,style:{paddingTop:0,paddingBottom:0}},r.a.createElement(dt,null)))),r.a.createElement(d.a,{className:"center",style:{top:"6rem",height:e,overflow:"auto",paddingBottom:"1rem"}},r.a.createElement(l.a,{exact:!0,path:"/",render:function(e){return r.a.createElement(Kt,e)}}),Object.keys(ft).map(function(e){return r.a.createElement(l.a,Object.assign({exact:!0},ft[e]))}))))},null),document.getElementById("react-app"))}},[[303,1,2]]]);
//# sourceMappingURL=main.94815c24.chunk.js.map